Dataset: filtered-h-and-m, Users: 1371716, Items: 105439
Generating training data...
[Epoch 1] Train BCE loss: 0.398133
num_hit:	@1	@3	@5	@10
		0.0135	0.0405	0.0647	0.1200	
MAP_score:	@1	@3	@5	@10
		0.0135	0.0248	0.0303	0.0374	
NDCG_score:	@1	@3	@5	@10
		0.0135	0.0288	0.0387	0.0564	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_bm25.csv
âœ… [Epoch 1] New best HR@10: 0.1200 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 2] Train BCE loss: 0.252611
num_hit:	@1	@3	@5	@10
		0.0168	0.0535	0.0855	0.1559	
MAP_score:	@1	@3	@5	@10
		0.0168	0.0321	0.0394	0.0485	
NDCG_score:	@1	@3	@5	@10
		0.0168	0.0376	0.0507	0.0732	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_bm25.csv
âœ… [Epoch 2] New best HR@10: 0.1559 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 3] Train BCE loss: 0.210279
num_hit:	@1	@3	@5	@10
		0.0299	0.0832	0.1315	0.2116	
MAP_score:	@1	@3	@5	@10
		0.0299	0.0524	0.0633	0.0740	
NDCG_score:	@1	@3	@5	@10
		0.0299	0.0602	0.0801	0.1060	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_bm25.csv
âœ… [Epoch 3] New best HR@10: 0.2116 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 4] Train BCE loss: 0.170129
num_hit:	@1	@3	@5	@10
		0.0407	0.1104	0.1628	0.2578	
MAP_score:	@1	@3	@5	@10
		0.0407	0.0703	0.0822	0.0947	
NDCG_score:	@1	@3	@5	@10
		0.0407	0.0805	0.1020	0.1326	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_bm25.csv
âœ… [Epoch 4] New best HR@10: 0.2578 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 5] Train BCE loss: 0.150466
num_hit:	@1	@3	@5	@10
		0.0441	0.1219	0.1800	0.2819	
MAP_score:	@1	@3	@5	@10
		0.0441	0.0770	0.0900	0.1036	
NDCG_score:	@1	@3	@5	@10
		0.0441	0.0885	0.1122	0.1451	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_bm25.csv
âœ… [Epoch 5] New best HR@10: 0.2819 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 6] Train BCE loss: 0.137345
num_hit:	@1	@3	@5	@10
		0.0464	0.1269	0.1884	0.2968	
MAP_score:	@1	@3	@5	@10
		0.0464	0.0804	0.0943	0.1086	
NDCG_score:	@1	@3	@5	@10
		0.0464	0.0923	0.1175	0.1523	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_bm25.csv
âœ… [Epoch 6] New best HR@10: 0.2968 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 7] Train BCE loss: 0.128049
num_hit:	@1	@3	@5	@10
		0.0473	0.1253	0.1896	0.2987	
MAP_score:	@1	@3	@5	@10
		0.0473	0.0801	0.0947	0.1090	
NDCG_score:	@1	@3	@5	@10
		0.0473	0.0916	0.1180	0.1530	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_bm25.csv
âœ… [Epoch 7] New best HR@10: 0.2987 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 8] Train BCE loss: 0.120791
num_hit:	@1	@3	@5	@10
		0.0456	0.1247	0.1885	0.2993	
MAP_score:	@1	@3	@5	@10
		0.0456	0.0786	0.0930	0.1075	
NDCG_score:	@1	@3	@5	@10
		0.0456	0.0904	0.1165	0.1521	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_bm25.csv
âœ… [Epoch 8] New best HR@10: 0.2993 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 9] Train BCE loss: 0.114708
num_hit:	@1	@3	@5	@10
		0.0442	0.1249	0.1861	0.2936	
MAP_score:	@1	@3	@5	@10
		0.0442	0.0783	0.0921	0.1063	
NDCG_score:	@1	@3	@5	@10
		0.0442	0.0902	0.1153	0.1499	
[Epoch 9] HR@10 = 0.2936, best = 0.2993 (epoch 8)
[Epoch 10] Train BCE loss: 0.109000
num_hit:	@1	@3	@5	@10
		0.0451	0.1221	0.1825	0.2880	
MAP_score:	@1	@3	@5	@10
		0.0451	0.0779	0.0915	0.1053	
NDCG_score:	@1	@3	@5	@10
		0.0451	0.0892	0.1139	0.1478	
[Epoch 10] HR@10 = 0.2880, best = 0.2993 (epoch 8)
[Epoch 11] Train BCE loss: 0.103341
num_hit:	@1	@3	@5	@10
		0.0440	0.1228	0.1798	0.2873	
MAP_score:	@1	@3	@5	@10
		0.0440	0.0773	0.0901	0.1043	
NDCG_score:	@1	@3	@5	@10
		0.0440	0.0889	0.1122	0.1468	
[Epoch 11] HR@10 = 0.2873, best = 0.2993 (epoch 8)
[Epoch 12] Train BCE loss: 0.097613
num_hit:	@1	@3	@5	@10
		0.0440	0.1184	0.1764	0.2831	
MAP_score:	@1	@3	@5	@10
		0.0440	0.0753	0.0885	0.1024	
NDCG_score:	@1	@3	@5	@10
		0.0440	0.0863	0.1101	0.1443	
[Epoch 12] HR@10 = 0.2831, best = 0.2993 (epoch 8)
[Epoch 13] Train BCE loss: 0.091626
num_hit:	@1	@3	@5	@10
		0.0433	0.1180	0.1807	0.2836	
MAP_score:	@1	@3	@5	@10
		0.0433	0.0746	0.0888	0.1022	
NDCG_score:	@1	@3	@5	@10
		0.0433	0.0857	0.1114	0.1443	
[Epoch 13] HR@10 = 0.2836, best = 0.2993 (epoch 8)
[Epoch 14] Train BCE loss: 0.085395
num_hit:	@1	@3	@5	@10
		0.0431	0.1144	0.1712	0.2762	
MAP_score:	@1	@3	@5	@10
		0.0431	0.0732	0.0861	0.0999	
NDCG_score:	@1	@3	@5	@10
		0.0431	0.0837	0.1071	0.1408	
[Epoch 14] HR@10 = 0.2762, best = 0.2993 (epoch 8)
[Epoch 15] Train BCE loss: 0.078707
num_hit:	@1	@3	@5	@10
		0.0414	0.1146	0.1705	0.2772	
MAP_score:	@1	@3	@5	@10
		0.0414	0.0719	0.0845	0.0985	
NDCG_score:	@1	@3	@5	@10
		0.0414	0.0828	0.1056	0.1399	
[Epoch 15] HR@10 = 0.2772, best = 0.2993 (epoch 8)
[Epoch 16] Train BCE loss: 0.071930
num_hit:	@1	@3	@5	@10
		0.0406	0.1126	0.1691	0.2738	
MAP_score:	@1	@3	@5	@10
		0.0406	0.0712	0.0841	0.0978	
NDCG_score:	@1	@3	@5	@10
		0.0406	0.0818	0.1050	0.1387	
[Epoch 16] HR@10 = 0.2738, best = 0.2993 (epoch 8)
[Epoch 17] Train BCE loss: 0.064967
num_hit:	@1	@3	@5	@10
		0.0388	0.1112	0.1656	0.2754	
MAP_score:	@1	@3	@5	@10
		0.0388	0.0695	0.0817	0.0961	
NDCG_score:	@1	@3	@5	@10
		0.0388	0.0802	0.1024	0.1377	
[Epoch 17] HR@10 = 0.2754, best = 0.2993 (epoch 8)
[Epoch 18] Train BCE loss: 0.057940
num_hit:	@1	@3	@5	@10
		0.0396	0.1104	0.1656	0.2779	
MAP_score:	@1	@3	@5	@10
		0.0396	0.0698	0.0823	0.0969	
NDCG_score:	@1	@3	@5	@10
		0.0396	0.0801	0.1028	0.1387	
[Epoch 18] HR@10 = 0.2779, best = 0.2993 (epoch 8)
[Epoch 19] Train BCE loss: 0.050932
num_hit:	@1	@3	@5	@10
		0.0398	0.1105	0.1668	0.2788	
MAP_score:	@1	@3	@5	@10
		0.0398	0.0697	0.0824	0.0970	
NDCG_score:	@1	@3	@5	@10
		0.0398	0.0801	0.1031	0.1390	
[Epoch 19] HR@10 = 0.2788, best = 0.2993 (epoch 8)
[Epoch 20] Train BCE loss: 0.044022
num_hit:	@1	@3	@5	@10
		0.0406	0.1073	0.1634	0.2769	
MAP_score:	@1	@3	@5	@10
		0.0406	0.0689	0.0816	0.0966	
NDCG_score:	@1	@3	@5	@10
		0.0406	0.0787	0.1017	0.1382	
[Epoch 20] HR@10 = 0.2769, best = 0.2993 (epoch 8)
[Epoch 21] Train BCE loss: 0.037579
num_hit:	@1	@3	@5	@10
		0.0402	0.1093	0.1651	0.2824	
MAP_score:	@1	@3	@5	@10
		0.0402	0.0695	0.0820	0.0973	
NDCG_score:	@1	@3	@5	@10
		0.0402	0.0797	0.1024	0.1400	
[Epoch 21] HR@10 = 0.2824, best = 0.2993 (epoch 8)
[Epoch 22] Train BCE loss: 0.031451
num_hit:	@1	@3	@5	@10
		0.0398	0.1089	0.1641	0.2844	
MAP_score:	@1	@3	@5	@10
		0.0398	0.0689	0.0813	0.0972	
NDCG_score:	@1	@3	@5	@10
		0.0398	0.0791	0.1017	0.1404	
[Epoch 22] HR@10 = 0.2844, best = 0.2993 (epoch 8)
[Epoch 23] Train BCE loss: 0.025836
num_hit:	@1	@3	@5	@10
		0.0414	0.1082	0.1653	0.2874	
MAP_score:	@1	@3	@5	@10
		0.0414	0.0693	0.0822	0.0981	
NDCG_score:	@1	@3	@5	@10
		0.0414	0.0792	0.1026	0.1417	
[Epoch 23] HR@10 = 0.2874, best = 0.2993 (epoch 8)
[Epoch 24] Train BCE loss: 0.020832
num_hit:	@1	@3	@5	@10
		0.0399	0.1071	0.1651	0.2898	
MAP_score:	@1	@3	@5	@10
		0.0399	0.0681	0.0812	0.0976	
NDCG_score:	@1	@3	@5	@10
		0.0399	0.0781	0.1018	0.1418	
[Epoch 24] HR@10 = 0.2898, best = 0.2993 (epoch 8)
[Epoch 25] Train BCE loss: 0.016470
num_hit:	@1	@3	@5	@10
		0.0404	0.1062	0.1653	0.2894	
MAP_score:	@1	@3	@5	@10
		0.0404	0.0683	0.0816	0.0978	
NDCG_score:	@1	@3	@5	@10
		0.0404	0.0780	0.1022	0.1420	
[Epoch 25] HR@10 = 0.2894, best = 0.2993 (epoch 8)
[Epoch 26] Train BCE loss: 0.012876
num_hit:	@1	@3	@5	@10
		0.0384	0.1064	0.1645	0.2896	
MAP_score:	@1	@3	@5	@10
		0.0384	0.0668	0.0799	0.0962	
NDCG_score:	@1	@3	@5	@10
		0.0384	0.0769	0.1007	0.1408	
[Epoch 26] HR@10 = 0.2896, best = 0.2993 (epoch 8)
[Epoch 27] Train BCE loss: 0.009894
num_hit:	@1	@3	@5	@10
		0.0388	0.1044	0.1675	0.2914	
MAP_score:	@1	@3	@5	@10
		0.0388	0.0665	0.0808	0.0970	
NDCG_score:	@1	@3	@5	@10
		0.0388	0.0762	0.1020	0.1418	
[Epoch 27] HR@10 = 0.2914, best = 0.2993 (epoch 8)
[Epoch 28] Train BCE loss: 0.007585
num_hit:	@1	@3	@5	@10
		0.0387	0.1079	0.1676	0.2948	
MAP_score:	@1	@3	@5	@10
		0.0387	0.0677	0.0812	0.0980	
NDCG_score:	@1	@3	@5	@10
		0.0387	0.0780	0.1025	0.1434	
[Epoch 28] HR@10 = 0.2948, best = 0.2993 (epoch 8)
[Epoch 29] Train BCE loss: 0.005690
num_hit:	@1	@3	@5	@10
		0.0374	0.1074	0.1671	0.2933	
MAP_score:	@1	@3	@5	@10
		0.0374	0.0671	0.0805	0.0971	
NDCG_score:	@1	@3	@5	@10
		0.0374	0.0774	0.1018	0.1424	
[Epoch 29] HR@10 = 0.2933, best = 0.2993 (epoch 8)
[Epoch 30] Train BCE loss: 0.004254
num_hit:	@1	@3	@5	@10
		0.0388	0.1058	0.1696	0.2940	
MAP_score:	@1	@3	@5	@10
		0.0388	0.0673	0.0816	0.0981	
NDCG_score:	@1	@3	@5	@10
		0.0388	0.0771	0.1032	0.1433	
[Epoch 30] HR@10 = 0.2940, best = 0.2993 (epoch 8)
[Epoch 31] Train BCE loss: 0.003200
num_hit:	@1	@3	@5	@10
		0.0369	0.1053	0.1702	0.2944	
MAP_score:	@1	@3	@5	@10
		0.0369	0.0660	0.0806	0.0970	
NDCG_score:	@1	@3	@5	@10
		0.0369	0.0760	0.1026	0.1426	
[Epoch 31] HR@10 = 0.2944, best = 0.2993 (epoch 8)
[Epoch 32] Train BCE loss: 0.002418
num_hit:	@1	@3	@5	@10
		0.0374	0.1071	0.1709	0.2959	
MAP_score:	@1	@3	@5	@10
		0.0374	0.0667	0.0810	0.0975	
NDCG_score:	@1	@3	@5	@10
		0.0374	0.0770	0.1031	0.1433	
[Epoch 32] HR@10 = 0.2959, best = 0.2993 (epoch 8)
[Epoch 33] Train BCE loss: 0.001876
num_hit:	@1	@3	@5	@10
		0.0365	0.1078	0.1706	0.2948	
MAP_score:	@1	@3	@5	@10
		0.0365	0.0666	0.0808	0.0973	
NDCG_score:	@1	@3	@5	@10
		0.0365	0.0772	0.1028	0.1429	
[Epoch 33] HR@10 = 0.2948, best = 0.2993 (epoch 8)
[Epoch 34] Train BCE loss: 0.001421
num_hit:	@1	@3	@5	@10
		0.0361	0.1075	0.1728	0.2966	
MAP_score:	@1	@3	@5	@10
		0.0361	0.0663	0.0810	0.0974	
NDCG_score:	@1	@3	@5	@10
		0.0361	0.0768	0.1035	0.1434	
[Epoch 34] HR@10 = 0.2966, best = 0.2993 (epoch 8)
[Epoch 35] Train BCE loss: 0.001120
num_hit:	@1	@3	@5	@10
		0.0359	0.1075	0.1725	0.2978	
MAP_score:	@1	@3	@5	@10
		0.0359	0.0663	0.0809	0.0974	
NDCG_score:	@1	@3	@5	@10
		0.0359	0.0768	0.1034	0.1437	
[Epoch 35] HR@10 = 0.2978, best = 0.2993 (epoch 8)
[Epoch 36] Train BCE loss: 0.000893
num_hit:	@1	@3	@5	@10
		0.0345	0.1067	0.1705	0.2966	
MAP_score:	@1	@3	@5	@10
		0.0345	0.0652	0.0796	0.0964	
NDCG_score:	@1	@3	@5	@10
		0.0345	0.0758	0.1019	0.1426	
[Epoch 36] HR@10 = 0.2966, best = 0.2993 (epoch 8)
[Epoch 37] Train BCE loss: 0.000717
num_hit:	@1	@3	@5	@10
		0.0342	0.1082	0.1725	0.2976	
MAP_score:	@1	@3	@5	@10
		0.0342	0.0655	0.0800	0.0966	
NDCG_score:	@1	@3	@5	@10
		0.0342	0.0764	0.1027	0.1431	
[Epoch 37] HR@10 = 0.2976, best = 0.2993 (epoch 8)
[Epoch 38] Train BCE loss: 0.000586
num_hit:	@1	@3	@5	@10
		0.0340	0.1086	0.1726	0.2991	
MAP_score:	@1	@3	@5	@10
		0.0340	0.0655	0.0800	0.0967	
NDCG_score:	@1	@3	@5	@10
		0.0340	0.0765	0.1027	0.1435	
[Epoch 38] HR@10 = 0.2991, best = 0.2993 (epoch 8)
[Epoch 39] Train BCE loss: 0.000485
num_hit:	@1	@3	@5	@10
		0.0333	0.1062	0.1732	0.3005	
MAP_score:	@1	@3	@5	@10
		0.0333	0.0642	0.0793	0.0961	
NDCG_score:	@1	@3	@5	@10
		0.0333	0.0749	0.1023	0.1433	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_bm25.csv
âœ… [Epoch 39] New best HR@10: 0.3005 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 40] Train BCE loss: 0.000406
num_hit:	@1	@3	@5	@10
		0.0320	0.1059	0.1726	0.3004	
MAP_score:	@1	@3	@5	@10
		0.0320	0.0634	0.0784	0.0953	
NDCG_score:	@1	@3	@5	@10
		0.0320	0.0742	0.1016	0.1427	
[Epoch 40] HR@10 = 0.3004, best = 0.3005 (epoch 39)
[Epoch 41] Train BCE loss: 0.000339
num_hit:	@1	@3	@5	@10
		0.0312	0.1065	0.1727	0.2992	
MAP_score:	@1	@3	@5	@10
		0.0312	0.0631	0.0781	0.0949	
NDCG_score:	@1	@3	@5	@10
		0.0312	0.0742	0.1013	0.1422	
[Epoch 41] HR@10 = 0.2992, best = 0.3005 (epoch 39)
[Epoch 42] Train BCE loss: 0.000287
num_hit:	@1	@3	@5	@10
		0.0308	0.1052	0.1732	0.3013	
MAP_score:	@1	@3	@5	@10
		0.0308	0.0625	0.0779	0.0948	
NDCG_score:	@1	@3	@5	@10
		0.0308	0.0734	0.1013	0.1425	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_bm25.csv
âœ… [Epoch 42] New best HR@10: 0.3013 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 43] Train BCE loss: 0.000246
num_hit:	@1	@3	@5	@10
		0.0295	0.1047	0.1735	0.3007	
MAP_score:	@1	@3	@5	@10
		0.0295	0.0614	0.0770	0.0938	
NDCG_score:	@1	@3	@5	@10
		0.0295	0.0724	0.1007	0.1417	
[Epoch 43] HR@10 = 0.3007, best = 0.3013 (epoch 42)
[Epoch 44] Train BCE loss: 0.000209
num_hit:	@1	@3	@5	@10
		0.0288	0.1046	0.1731	0.2993	
MAP_score:	@1	@3	@5	@10
		0.0288	0.0609	0.0764	0.0933	
NDCG_score:	@1	@3	@5	@10
		0.0288	0.0721	0.1002	0.1410	
[Epoch 44] HR@10 = 0.2993, best = 0.3013 (epoch 42)
[Epoch 45] Train BCE loss: 0.000178
num_hit:	@1	@3	@5	@10
		0.0280	0.1051	0.1736	0.3011	
MAP_score:	@1	@3	@5	@10
		0.0280	0.0605	0.0761	0.0930	
NDCG_score:	@1	@3	@5	@10
		0.0280	0.0719	0.1001	0.1412	
[Epoch 45] HR@10 = 0.3011, best = 0.3013 (epoch 42)
[Epoch 46] Train BCE loss: 0.000152
num_hit:	@1	@3	@5	@10
		0.0278	0.1046	0.1740	0.3002	
MAP_score:	@1	@3	@5	@10
		0.0278	0.0602	0.0760	0.0928	
NDCG_score:	@1	@3	@5	@10
		0.0278	0.0716	0.1000	0.1408	
[Epoch 46] HR@10 = 0.3002, best = 0.3013 (epoch 42)
[Epoch 47] Train BCE loss: 0.000132
num_hit:	@1	@3	@5	@10
		0.0267	0.1053	0.1729	0.3009	
MAP_score:	@1	@3	@5	@10
		0.0267	0.0597	0.0751	0.0921	
NDCG_score:	@1	@3	@5	@10
		0.0267	0.0714	0.0991	0.1405	
[Epoch 47] HR@10 = 0.3009, best = 0.3013 (epoch 42)
[Epoch 48] Train BCE loss: 0.000115
num_hit:	@1	@3	@5	@10
		0.0262	0.1042	0.1736	0.3007	
MAP_score:	@1	@3	@5	@10
		0.0262	0.0590	0.0748	0.0918	
NDCG_score:	@1	@3	@5	@10
		0.0262	0.0705	0.0991	0.1402	
[Epoch 48] HR@10 = 0.3007, best = 0.3013 (epoch 42)
[Epoch 49] Train BCE loss: 0.000101
num_hit:	@1	@3	@5	@10
		0.0251	0.1029	0.1751	0.3000	
MAP_score:	@1	@3	@5	@10
		0.0251	0.0579	0.0742	0.0908	
NDCG_score:	@1	@3	@5	@10
		0.0251	0.0694	0.0989	0.1393	
[Epoch 49] HR@10 = 0.3000, best = 0.3013 (epoch 42)
[Epoch 50] Train BCE loss: 0.000089
num_hit:	@1	@3	@5	@10
		0.0246	0.1034	0.1732	0.3011	
MAP_score:	@1	@3	@5	@10
		0.0246	0.0576	0.0735	0.0906	
NDCG_score:	@1	@3	@5	@10
		0.0246	0.0693	0.0980	0.1393	
[Epoch 50] HR@10 = 0.3011, best = 0.3013 (epoch 42)
Training completed. Last model saved to checkpoints/ncf_last_filtered-h-and-m.pt
