Dataset: filtered-h-and-m, Users: 1371716, Items: 105491
Generating training data...
[Epoch 1] Train BCE loss: 0.365450
num_hit:	@1	@3	@5	@10
		0.0149	0.0381	0.0602	0.1150	
MAP_score:	@1	@3	@5	@10
		0.0149	0.0245	0.0294	0.0365	
NDCG_score:	@1	@3	@5	@10
		0.0149	0.0279	0.0370	0.0544	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_tfidf.csv
âœ… [Epoch 1] New best HR@10: 0.1150 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 2] Train BCE loss: 0.200577
num_hit:	@1	@3	@5	@10
		0.0223	0.0535	0.0795	0.1451	
MAP_score:	@1	@3	@5	@10
		0.0223	0.0356	0.0414	0.0499	
NDCG_score:	@1	@3	@5	@10
		0.0223	0.0402	0.0508	0.0718	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_tfidf.csv
âœ… [Epoch 2] New best HR@10: 0.1451 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 3] Train BCE loss: 0.166663
num_hit:	@1	@3	@5	@10
		0.0281	0.0732	0.1118	0.1894	
MAP_score:	@1	@3	@5	@10
		0.0281	0.0474	0.0562	0.0663	
NDCG_score:	@1	@3	@5	@10
		0.0281	0.0540	0.0699	0.0948	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_tfidf.csv
âœ… [Epoch 3] New best HR@10: 0.1894 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 4] Train BCE loss: 0.145139
num_hit:	@1	@3	@5	@10
		0.0359	0.0971	0.1443	0.2387	
MAP_score:	@1	@3	@5	@10
		0.0359	0.0622	0.0728	0.0855	
NDCG_score:	@1	@3	@5	@10
		0.0359	0.0711	0.0904	0.1211	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_tfidf.csv
âœ… [Epoch 4] New best HR@10: 0.2387 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 5] Train BCE loss: 0.127267
num_hit:	@1	@3	@5	@10
		0.0388	0.1099	0.1680	0.2733	
MAP_score:	@1	@3	@5	@10
		0.0388	0.0689	0.0820	0.0960	
NDCG_score:	@1	@3	@5	@10
		0.0388	0.0794	0.1032	0.1371	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_tfidf.csv
âœ… [Epoch 5] New best HR@10: 0.2733 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 6] Train BCE loss: 0.115066
num_hit:	@1	@3	@5	@10
		0.0416	0.1210	0.1801	0.2886	
MAP_score:	@1	@3	@5	@10
		0.0416	0.0749	0.0882	0.1027	
NDCG_score:	@1	@3	@5	@10
		0.0416	0.0867	0.1109	0.1459	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_tfidf.csv
âœ… [Epoch 6] New best HR@10: 0.2886 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 7] Train BCE loss: 0.106329
num_hit:	@1	@3	@5	@10
		0.0426	0.1212	0.1855	0.2938	
MAP_score:	@1	@3	@5	@10
		0.0426	0.0759	0.0905	0.1047	
NDCG_score:	@1	@3	@5	@10
		0.0426	0.0875	0.1138	0.1487	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_tfidf.csv
âœ… [Epoch 7] New best HR@10: 0.2938 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 8] Train BCE loss: 0.099663
num_hit:	@1	@3	@5	@10
		0.0408	0.1228	0.1877	0.2970	
MAP_score:	@1	@3	@5	@10
		0.0408	0.0753	0.0900	0.1045	
NDCG_score:	@1	@3	@5	@10
		0.0408	0.0874	0.1141	0.1493	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_tfidf.csv
âœ… [Epoch 8] New best HR@10: 0.2970 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 9] Train BCE loss: 0.093757
num_hit:	@1	@3	@5	@10
		0.0404	0.1221	0.1832	0.2926	
MAP_score:	@1	@3	@5	@10
		0.0404	0.0744	0.0880	0.1026	
NDCG_score:	@1	@3	@5	@10
		0.0404	0.0866	0.1115	0.1468	
[Epoch 9] HR@10 = 0.2926, best = 0.2970 (epoch 8)
[Epoch 10] Train BCE loss: 0.088033
num_hit:	@1	@3	@5	@10
		0.0427	0.1164	0.1754	0.2866	
MAP_score:	@1	@3	@5	@10
		0.0427	0.0739	0.0873	0.1020	
NDCG_score:	@1	@3	@5	@10
		0.0427	0.0847	0.1090	0.1448	
[Epoch 10] HR@10 = 0.2866, best = 0.2970 (epoch 8)
[Epoch 11] Train BCE loss: 0.082478
num_hit:	@1	@3	@5	@10
		0.0389	0.1156	0.1759	0.2869	
MAP_score:	@1	@3	@5	@10
		0.0389	0.0711	0.0847	0.0993	
NDCG_score:	@1	@3	@5	@10
		0.0389	0.0824	0.1072	0.1428	
[Epoch 11] HR@10 = 0.2869, best = 0.2970 (epoch 8)
[Epoch 12] Train BCE loss: 0.076725
num_hit:	@1	@3	@5	@10
		0.0393	0.1116	0.1742	0.2834	
MAP_score:	@1	@3	@5	@10
		0.0393	0.0697	0.0838	0.0981	
NDCG_score:	@1	@3	@5	@10
		0.0393	0.0804	0.1060	0.1410	
[Epoch 12] HR@10 = 0.2834, best = 0.2970 (epoch 8)
[Epoch 13] Train BCE loss: 0.070686
num_hit:	@1	@3	@5	@10
		0.0380	0.1101	0.1700	0.2786	
MAP_score:	@1	@3	@5	@10
		0.0380	0.0683	0.0818	0.0961	
NDCG_score:	@1	@3	@5	@10
		0.0380	0.0790	0.1035	0.1384	
[Epoch 13] HR@10 = 0.2786, best = 0.2970 (epoch 8)
[Epoch 14] Train BCE loss: 0.064496
num_hit:	@1	@3	@5	@10
		0.0372	0.1076	0.1680	0.2790	
MAP_score:	@1	@3	@5	@10
		0.0372	0.0672	0.0808	0.0955	
NDCG_score:	@1	@3	@5	@10
		0.0372	0.0775	0.1023	0.1380	
[Epoch 14] HR@10 = 0.2790, best = 0.2970 (epoch 8)
[Epoch 15] Train BCE loss: 0.058098
num_hit:	@1	@3	@5	@10
		0.0377	0.1063	0.1690	0.2748	
MAP_score:	@1	@3	@5	@10
		0.0377	0.0668	0.0808	0.0948	
NDCG_score:	@1	@3	@5	@10
		0.0377	0.0769	0.1025	0.1365	
[Epoch 15] HR@10 = 0.2748, best = 0.2970 (epoch 8)
[Epoch 16] Train BCE loss: 0.051792
num_hit:	@1	@3	@5	@10
		0.0370	0.1075	0.1684	0.2761	
MAP_score:	@1	@3	@5	@10
		0.0370	0.0671	0.0807	0.0950	
NDCG_score:	@1	@3	@5	@10
		0.0370	0.0774	0.1023	0.1370	
[Epoch 16] HR@10 = 0.2761, best = 0.2970 (epoch 8)
[Epoch 17] Train BCE loss: 0.045409
num_hit:	@1	@3	@5	@10
		0.0365	0.1055	0.1651	0.2731	
MAP_score:	@1	@3	@5	@10
		0.0365	0.0660	0.0796	0.0939	
NDCG_score:	@1	@3	@5	@10
		0.0365	0.0761	0.1006	0.1354	
[Epoch 17] HR@10 = 0.2731, best = 0.2970 (epoch 8)
[Epoch 18] Train BCE loss: 0.039123
num_hit:	@1	@3	@5	@10
		0.0359	0.1074	0.1661	0.2768	
MAP_score:	@1	@3	@5	@10
		0.0359	0.0664	0.0798	0.0945	
NDCG_score:	@1	@3	@5	@10
		0.0359	0.0769	0.1011	0.1368	
[Epoch 18] HR@10 = 0.2768, best = 0.2970 (epoch 8)
[Epoch 19] Train BCE loss: 0.033115
num_hit:	@1	@3	@5	@10
		0.0378	0.1094	0.1706	0.2823	
MAP_score:	@1	@3	@5	@10
		0.0378	0.0679	0.0818	0.0966	
NDCG_score:	@1	@3	@5	@10
		0.0378	0.0785	0.1036	0.1397	
[Epoch 19] HR@10 = 0.2823, best = 0.2970 (epoch 8)
[Epoch 20] Train BCE loss: 0.027508
num_hit:	@1	@3	@5	@10
		0.0372	0.1080	0.1698	0.2817	
MAP_score:	@1	@3	@5	@10
		0.0372	0.0671	0.0811	0.0960	
NDCG_score:	@1	@3	@5	@10
		0.0372	0.0775	0.1029	0.1390	
[Epoch 20] HR@10 = 0.2817, best = 0.2970 (epoch 8)
[Epoch 21] Train BCE loss: 0.022343
num_hit:	@1	@3	@5	@10
		0.0381	0.1077	0.1725	0.2837	
MAP_score:	@1	@3	@5	@10
		0.0381	0.0674	0.0820	0.0967	
NDCG_score:	@1	@3	@5	@10
		0.0381	0.0777	0.1042	0.1400	
[Epoch 21] HR@10 = 0.2837, best = 0.2970 (epoch 8)
[Epoch 22] Train BCE loss: 0.017832
num_hit:	@1	@3	@5	@10
		0.0368	0.1090	0.1692	0.2842	
MAP_score:	@1	@3	@5	@10
		0.0368	0.0673	0.0809	0.0962	
NDCG_score:	@1	@3	@5	@10
		0.0368	0.0779	0.1026	0.1397	
[Epoch 22] HR@10 = 0.2842, best = 0.2970 (epoch 8)
[Epoch 23] Train BCE loss: 0.014003
num_hit:	@1	@3	@5	@10
		0.0374	0.1127	0.1724	0.2867	
MAP_score:	@1	@3	@5	@10
		0.0374	0.0690	0.0825	0.0975	
NDCG_score:	@1	@3	@5	@10
		0.0374	0.0802	0.1046	0.1414	
[Epoch 23] HR@10 = 0.2867, best = 0.2970 (epoch 8)
[Epoch 24] Train BCE loss: 0.010750
num_hit:	@1	@3	@5	@10
		0.0379	0.1105	0.1722	0.2851	
MAP_score:	@1	@3	@5	@10
		0.0379	0.0683	0.0822	0.0972	
NDCG_score:	@1	@3	@5	@10
		0.0379	0.0791	0.1043	0.1407	
[Epoch 24] HR@10 = 0.2851, best = 0.2970 (epoch 8)
[Epoch 25] Train BCE loss: 0.008146
num_hit:	@1	@3	@5	@10
		0.0383	0.1095	0.1739	0.2906	
MAP_score:	@1	@3	@5	@10
		0.0383	0.0681	0.0826	0.0980	
NDCG_score:	@1	@3	@5	@10
		0.0383	0.0786	0.1050	0.1426	
[Epoch 25] HR@10 = 0.2906, best = 0.2970 (epoch 8)
[Epoch 26] Train BCE loss: 0.006131
num_hit:	@1	@3	@5	@10
		0.0383	0.1117	0.1749	0.2890	
MAP_score:	@1	@3	@5	@10
		0.0383	0.0693	0.0834	0.0986	
NDCG_score:	@1	@3	@5	@10
		0.0383	0.0801	0.1059	0.1427	
[Epoch 26] HR@10 = 0.2890, best = 0.2970 (epoch 8)
[Epoch 27] Train BCE loss: 0.004624
num_hit:	@1	@3	@5	@10
		0.0383	0.1105	0.1759	0.2910	
MAP_score:	@1	@3	@5	@10
		0.0383	0.0687	0.0835	0.0988	
NDCG_score:	@1	@3	@5	@10
		0.0383	0.0794	0.1062	0.1434	
[Epoch 27] HR@10 = 0.2910, best = 0.2970 (epoch 8)
[Epoch 28] Train BCE loss: 0.003501
num_hit:	@1	@3	@5	@10
		0.0383	0.1137	0.1772	0.2908	
MAP_score:	@1	@3	@5	@10
		0.0383	0.0701	0.0844	0.0996	
NDCG_score:	@1	@3	@5	@10
		0.0383	0.0812	0.1072	0.1440	
[Epoch 28] HR@10 = 0.2908, best = 0.2970 (epoch 8)
[Epoch 29] Train BCE loss: 0.002631
num_hit:	@1	@3	@5	@10
		0.0368	0.1123	0.1752	0.2929	
MAP_score:	@1	@3	@5	@10
		0.0368	0.0688	0.0830	0.0987	
NDCG_score:	@1	@3	@5	@10
		0.0368	0.0799	0.1057	0.1438	
[Epoch 29] HR@10 = 0.2929, best = 0.2970 (epoch 8)
[Epoch 30] Train BCE loss: 0.002009
num_hit:	@1	@3	@5	@10
		0.0373	0.1133	0.1776	0.2917	
MAP_score:	@1	@3	@5	@10
		0.0373	0.0693	0.0837	0.0990	
NDCG_score:	@1	@3	@5	@10
		0.0373	0.0806	0.1068	0.1437	
[Epoch 30] HR@10 = 0.2917, best = 0.2970 (epoch 8)
[Epoch 31] Train BCE loss: 0.001562
num_hit:	@1	@3	@5	@10
		0.0382	0.1135	0.1779	0.2904	
MAP_score:	@1	@3	@5	@10
		0.0382	0.0700	0.0844	0.0995	
NDCG_score:	@1	@3	@5	@10
		0.0382	0.0811	0.1074	0.1438	
[Epoch 31] HR@10 = 0.2904, best = 0.2970 (epoch 8)
[Epoch 32] Train BCE loss: 0.001206
num_hit:	@1	@3	@5	@10
		0.0363	0.1115	0.1785	0.2919	
MAP_score:	@1	@3	@5	@10
		0.0363	0.0683	0.0835	0.0986	
NDCG_score:	@1	@3	@5	@10
		0.0363	0.0794	0.1068	0.1435	
[Epoch 32] HR@10 = 0.2919, best = 0.2970 (epoch 8)
[Epoch 33] Train BCE loss: 0.000953
num_hit:	@1	@3	@5	@10
		0.0361	0.1156	0.1809	0.2944	
MAP_score:	@1	@3	@5	@10
		0.0361	0.0695	0.0842	0.0993	
NDCG_score:	@1	@3	@5	@10
		0.0361	0.0813	0.1080	0.1446	
[Epoch 33] HR@10 = 0.2944, best = 0.2970 (epoch 8)
[Epoch 34] Train BCE loss: 0.000764
num_hit:	@1	@3	@5	@10
		0.0364	0.1155	0.1805	0.2932	
MAP_score:	@1	@3	@5	@10
		0.0364	0.0694	0.0839	0.0989	
NDCG_score:	@1	@3	@5	@10
		0.0364	0.0811	0.1076	0.1441	
[Epoch 34] HR@10 = 0.2932, best = 0.2970 (epoch 8)
[Epoch 35] Train BCE loss: 0.000616
num_hit:	@1	@3	@5	@10
		0.0364	0.1154	0.1810	0.2936	
MAP_score:	@1	@3	@5	@10
		0.0364	0.0696	0.0843	0.0993	
NDCG_score:	@1	@3	@5	@10
		0.0364	0.0813	0.1081	0.1445	
[Epoch 35] HR@10 = 0.2936, best = 0.2970 (epoch 8)
[Epoch 36] Train BCE loss: 0.000499
num_hit:	@1	@3	@5	@10
		0.0355	0.1154	0.1828	0.2949	
MAP_score:	@1	@3	@5	@10
		0.0355	0.0691	0.0843	0.0991	
NDCG_score:	@1	@3	@5	@10
		0.0355	0.0809	0.1085	0.1446	
[Epoch 36] HR@10 = 0.2949, best = 0.2970 (epoch 8)
[Epoch 37] Train BCE loss: 0.000406
num_hit:	@1	@3	@5	@10
		0.0362	0.1149	0.1804	0.2938	
MAP_score:	@1	@3	@5	@10
		0.0362	0.0694	0.0841	0.0993	
NDCG_score:	@1	@3	@5	@10
		0.0362	0.0810	0.1078	0.1445	
[Epoch 37] HR@10 = 0.2938, best = 0.2970 (epoch 8)
[Epoch 38] Train BCE loss: 0.000334
num_hit:	@1	@3	@5	@10
		0.0346	0.1152	0.1825	0.2960	
MAP_score:	@1	@3	@5	@10
		0.0346	0.0684	0.0836	0.0987	
NDCG_score:	@1	@3	@5	@10
		0.0346	0.0804	0.1079	0.1445	
[Epoch 38] HR@10 = 0.2960, best = 0.2970 (epoch 8)
[Epoch 39] Train BCE loss: 0.000268
num_hit:	@1	@3	@5	@10
		0.0344	0.1149	0.1821	0.2967	
MAP_score:	@1	@3	@5	@10
		0.0344	0.0683	0.0834	0.0986	
NDCG_score:	@1	@3	@5	@10
		0.0344	0.0802	0.1076	0.1446	
[Epoch 39] HR@10 = 0.2967, best = 0.2970 (epoch 8)
[Epoch 40] Train BCE loss: 0.000216
num_hit:	@1	@3	@5	@10
		0.0339	0.1164	0.1817	0.2963	
MAP_score:	@1	@3	@5	@10
		0.0339	0.0686	0.0833	0.0985	
NDCG_score:	@1	@3	@5	@10
		0.0339	0.0808	0.1075	0.1445	
[Epoch 40] HR@10 = 0.2963, best = 0.2970 (epoch 8)
[Epoch 41] Train BCE loss: 0.000178
num_hit:	@1	@3	@5	@10
		0.0334	0.1145	0.1819	0.2961	
MAP_score:	@1	@3	@5	@10
		0.0334	0.0673	0.0825	0.0977	
NDCG_score:	@1	@3	@5	@10
		0.0334	0.0793	0.1069	0.1438	
[Epoch 41] HR@10 = 0.2961, best = 0.2970 (epoch 8)
[Epoch 42] Train BCE loss: 0.000147
num_hit:	@1	@3	@5	@10
		0.0324	0.1154	0.1842	0.2963	
MAP_score:	@1	@3	@5	@10
		0.0324	0.0672	0.0828	0.0977	
NDCG_score:	@1	@3	@5	@10
		0.0324	0.0795	0.1077	0.1439	
[Epoch 42] HR@10 = 0.2963, best = 0.2970 (epoch 8)
[Epoch 43] Train BCE loss: 0.000123
num_hit:	@1	@3	@5	@10
		0.0330	0.1138	0.1832	0.2968	
MAP_score:	@1	@3	@5	@10
		0.0330	0.0667	0.0824	0.0975	
NDCG_score:	@1	@3	@5	@10
		0.0330	0.0787	0.1072	0.1438	
[Epoch 43] HR@10 = 0.2968, best = 0.2970 (epoch 8)
[Epoch 44] Train BCE loss: 0.000103
num_hit:	@1	@3	@5	@10
		0.0324	0.1139	0.1840	0.2967	
MAP_score:	@1	@3	@5	@10
		0.0324	0.0663	0.0821	0.0970	
NDCG_score:	@1	@3	@5	@10
		0.0324	0.0785	0.1071	0.1434	
[Epoch 44] HR@10 = 0.2967, best = 0.2970 (epoch 8)
[Epoch 45] Train BCE loss: 0.000087
num_hit:	@1	@3	@5	@10
		0.0315	0.1140	0.1833	0.2966	
MAP_score:	@1	@3	@5	@10
		0.0315	0.0662	0.0818	0.0969	
NDCG_score:	@1	@3	@5	@10
		0.0315	0.0784	0.1068	0.1434	
[Epoch 45] HR@10 = 0.2966, best = 0.2970 (epoch 8)
[Epoch 46] Train BCE loss: 0.000073
num_hit:	@1	@3	@5	@10
		0.0304	0.1139	0.1850	0.2988	
MAP_score:	@1	@3	@5	@10
		0.0304	0.0652	0.0813	0.0963	
NDCG_score:	@1	@3	@5	@10
		0.0304	0.0776	0.1068	0.1434	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_tfidf.csv
âœ… [Epoch 46] New best HR@10: 0.2988 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 47] Train BCE loss: 0.000062
num_hit:	@1	@3	@5	@10
		0.0303	0.1129	0.1842	0.2962	
MAP_score:	@1	@3	@5	@10
		0.0303	0.0645	0.0806	0.0955	
NDCG_score:	@1	@3	@5	@10
		0.0303	0.0768	0.1060	0.1422	
[Epoch 47] HR@10 = 0.2962, best = 0.2988 (epoch 46)
[Epoch 48] Train BCE loss: 0.000053
num_hit:	@1	@3	@5	@10
		0.0298	0.1129	0.1841	0.2968	
MAP_score:	@1	@3	@5	@10
		0.0298	0.0643	0.0804	0.0953	
NDCG_score:	@1	@3	@5	@10
		0.0298	0.0767	0.1059	0.1422	
[Epoch 48] HR@10 = 0.2968, best = 0.2988 (epoch 46)
[Epoch 49] Train BCE loss: 0.000046
num_hit:	@1	@3	@5	@10
		0.0301	0.1124	0.1838	0.2981	
MAP_score:	@1	@3	@5	@10
		0.0301	0.0644	0.0805	0.0958	
NDCG_score:	@1	@3	@5	@10
		0.0301	0.0766	0.1059	0.1428	
[Epoch 49] HR@10 = 0.2981, best = 0.2988 (epoch 46)
[Epoch 50] Train BCE loss: 0.000040
num_hit:	@1	@3	@5	@10
		0.0291	0.1121	0.1842	0.2977	
MAP_score:	@1	@3	@5	@10
		0.0291	0.0635	0.0799	0.0950	
NDCG_score:	@1	@3	@5	@10
		0.0291	0.0759	0.1055	0.1421	
[Epoch 50] HR@10 = 0.2977, best = 0.2988 (epoch 46)
Training completed. Last model saved to checkpoints/ncf_last_filtered-h-and-m.pt
