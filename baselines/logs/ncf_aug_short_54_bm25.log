Dataset: filtered-h-and-m, Users: 1371716, Items: 105439
Generating training data...
[Epoch 1] Train BCE loss: 0.381947
num_hit:	@1	@3	@5	@10
		0.0138	0.0361	0.0580	0.1117	
MAP_score:	@1	@3	@5	@10
		0.0138	0.0231	0.0280	0.0350	
NDCG_score:	@1	@3	@5	@10
		0.0138	0.0264	0.0354	0.0526	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_bm25.csv
âœ… [Epoch 1] New best HR@10: 0.1117 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 2] Train BCE loss: 0.207936
num_hit:	@1	@3	@5	@10
		0.0227	0.0613	0.0881	0.1492	
MAP_score:	@1	@3	@5	@10
		0.0227	0.0392	0.0452	0.0532	
NDCG_score:	@1	@3	@5	@10
		0.0227	0.0448	0.0558	0.0753	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_bm25.csv
âœ… [Epoch 2] New best HR@10: 0.1492 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 3] Train BCE loss: 0.164903
num_hit:	@1	@3	@5	@10
		0.0331	0.0809	0.1221	0.1960	
MAP_score:	@1	@3	@5	@10
		0.0331	0.0533	0.0626	0.0723	
NDCG_score:	@1	@3	@5	@10
		0.0331	0.0603	0.0772	0.1009	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_bm25.csv
âœ… [Epoch 3] New best HR@10: 0.1960 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 4] Train BCE loss: 0.144058
num_hit:	@1	@3	@5	@10
		0.0358	0.1034	0.1478	0.2408	
MAP_score:	@1	@3	@5	@10
		0.0358	0.0643	0.0744	0.0866	
NDCG_score:	@1	@3	@5	@10
		0.0358	0.0743	0.0925	0.1224	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_bm25.csv
âœ… [Epoch 4] New best HR@10: 0.2408 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 5] Train BCE loss: 0.127020
num_hit:	@1	@3	@5	@10
		0.0394	0.1121	0.1704	0.2722	
MAP_score:	@1	@3	@5	@10
		0.0394	0.0699	0.0831	0.0964	
NDCG_score:	@1	@3	@5	@10
		0.0394	0.0807	0.1045	0.1372	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_bm25.csv
âœ… [Epoch 5] New best HR@10: 0.2722 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 6] Train BCE loss: 0.115006
num_hit:	@1	@3	@5	@10
		0.0421	0.1209	0.1787	0.2870	
MAP_score:	@1	@3	@5	@10
		0.0421	0.0748	0.0880	0.1023	
NDCG_score:	@1	@3	@5	@10
		0.0421	0.0865	0.1103	0.1452	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_bm25.csv
âœ… [Epoch 6] New best HR@10: 0.2870 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 7] Train BCE loss: 0.106131
num_hit:	@1	@3	@5	@10
		0.0424	0.1226	0.1804	0.2928	
MAP_score:	@1	@3	@5	@10
		0.0424	0.0763	0.0894	0.1043	
NDCG_score:	@1	@3	@5	@10
		0.0424	0.0882	0.1119	0.1481	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_bm25.csv
âœ… [Epoch 7] New best HR@10: 0.2928 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 8] Train BCE loss: 0.098938
num_hit:	@1	@3	@5	@10
		0.0410	0.1211	0.1852	0.2936	
MAP_score:	@1	@3	@5	@10
		0.0410	0.0748	0.0893	0.1035	
NDCG_score:	@1	@3	@5	@10
		0.0410	0.0866	0.1129	0.1477	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_54_bm25.csv
âœ… [Epoch 8] New best HR@10: 0.2936 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 9] Train BCE loss: 0.092460
num_hit:	@1	@3	@5	@10
		0.0415	0.1168	0.1783	0.2888	
MAP_score:	@1	@3	@5	@10
		0.0415	0.0731	0.0872	0.1017	
NDCG_score:	@1	@3	@5	@10
		0.0415	0.0843	0.1096	0.1452	
[Epoch 9] HR@10 = 0.2888, best = 0.2936 (epoch 8)
[Epoch 10] Train BCE loss: 0.086304
num_hit:	@1	@3	@5	@10
		0.0402	0.1157	0.1765	0.2871	
MAP_score:	@1	@3	@5	@10
		0.0402	0.0721	0.0858	0.1002	
NDCG_score:	@1	@3	@5	@10
		0.0402	0.0832	0.1081	0.1435	
[Epoch 10] HR@10 = 0.2871, best = 0.2936 (epoch 8)
[Epoch 11] Train BCE loss: 0.080235
num_hit:	@1	@3	@5	@10
		0.0410	0.1138	0.1735	0.2867	
MAP_score:	@1	@3	@5	@10
		0.0410	0.0717	0.0853	0.0999	
NDCG_score:	@1	@3	@5	@10
		0.0410	0.0825	0.1070	0.1431	
[Epoch 11] HR@10 = 0.2867, best = 0.2936 (epoch 8)
[Epoch 12] Train BCE loss: 0.074101
num_hit:	@1	@3	@5	@10
		0.0405	0.1141	0.1720	0.2799	
MAP_score:	@1	@3	@5	@10
		0.0405	0.0714	0.0844	0.0984	
NDCG_score:	@1	@3	@5	@10
		0.0405	0.0823	0.1059	0.1405	
[Epoch 12] HR@10 = 0.2799, best = 0.2936 (epoch 8)
[Epoch 13] Train BCE loss: 0.067917
num_hit:	@1	@3	@5	@10
		0.0409	0.1138	0.1666	0.2744	
MAP_score:	@1	@3	@5	@10
		0.0409	0.0715	0.0835	0.0977	
NDCG_score:	@1	@3	@5	@10
		0.0409	0.0823	0.1040	0.1386	
[Epoch 13] HR@10 = 0.2744, best = 0.2936 (epoch 8)
[Epoch 14] Train BCE loss: 0.061540
num_hit:	@1	@3	@5	@10
		0.0403	0.1106	0.1686	0.2734	
MAP_score:	@1	@3	@5	@10
		0.0403	0.0701	0.0832	0.0969	
NDCG_score:	@1	@3	@5	@10
		0.0403	0.0804	0.1042	0.1378	
[Epoch 14] HR@10 = 0.2734, best = 0.2936 (epoch 8)
[Epoch 15] Train BCE loss: 0.055186
num_hit:	@1	@3	@5	@10
		0.0399	0.1108	0.1650	0.2738	
MAP_score:	@1	@3	@5	@10
		0.0399	0.0700	0.0822	0.0965	
NDCG_score:	@1	@3	@5	@10
		0.0399	0.0804	0.1026	0.1376	
[Epoch 15] HR@10 = 0.2738, best = 0.2936 (epoch 8)
[Epoch 16] Train BCE loss: 0.048785
num_hit:	@1	@3	@5	@10
		0.0399	0.1118	0.1665	0.2709	
MAP_score:	@1	@3	@5	@10
		0.0399	0.0703	0.0827	0.0964	
NDCG_score:	@1	@3	@5	@10
		0.0399	0.0809	0.1033	0.1369	
[Epoch 16] HR@10 = 0.2709, best = 0.2936 (epoch 8)
[Epoch 17] Train BCE loss: 0.042424
num_hit:	@1	@3	@5	@10
		0.0386	0.1093	0.1649	0.2710	
MAP_score:	@1	@3	@5	@10
		0.0386	0.0683	0.0808	0.0947	
NDCG_score:	@1	@3	@5	@10
		0.0386	0.0787	0.1015	0.1356	
[Epoch 17] HR@10 = 0.2710, best = 0.2936 (epoch 8)
[Epoch 18] Train BCE loss: 0.036525
num_hit:	@1	@3	@5	@10
		0.0387	0.1088	0.1660	0.2711	
MAP_score:	@1	@3	@5	@10
		0.0387	0.0684	0.0814	0.0951	
NDCG_score:	@1	@3	@5	@10
		0.0387	0.0787	0.1022	0.1359	
[Epoch 18] HR@10 = 0.2711, best = 0.2936 (epoch 8)
[Epoch 19] Train BCE loss: 0.030615
num_hit:	@1	@3	@5	@10
		0.0385	0.1109	0.1686	0.2751	
MAP_score:	@1	@3	@5	@10
		0.0385	0.0689	0.0819	0.0960	
NDCG_score:	@1	@3	@5	@10
		0.0385	0.0796	0.1032	0.1375	
[Epoch 19] HR@10 = 0.2751, best = 0.2936 (epoch 8)
[Epoch 20] Train BCE loss: 0.025132
num_hit:	@1	@3	@5	@10
		0.0393	0.1099	0.1679	0.2765	
MAP_score:	@1	@3	@5	@10
		0.0393	0.0690	0.0821	0.0963	
NDCG_score:	@1	@3	@5	@10
		0.0393	0.0795	0.1032	0.1381	
[Epoch 20] HR@10 = 0.2765, best = 0.2936 (epoch 8)
[Epoch 21] Train BCE loss: 0.020283
num_hit:	@1	@3	@5	@10
		0.0388	0.1063	0.1672	0.2756	
MAP_score:	@1	@3	@5	@10
		0.0388	0.0675	0.0813	0.0955	
NDCG_score:	@1	@3	@5	@10
		0.0388	0.0774	0.1024	0.1372	
[Epoch 21] HR@10 = 0.2756, best = 0.2936 (epoch 8)
[Epoch 22] Train BCE loss: 0.015914
num_hit:	@1	@3	@5	@10
		0.0394	0.1080	0.1694	0.2758	
MAP_score:	@1	@3	@5	@10
		0.0394	0.0681	0.0820	0.0961	
NDCG_score:	@1	@3	@5	@10
		0.0394	0.0783	0.1034	0.1377	
[Epoch 22] HR@10 = 0.2758, best = 0.2936 (epoch 8)
[Epoch 23] Train BCE loss: 0.012200
num_hit:	@1	@3	@5	@10
		0.0411	0.1066	0.1693	0.2800	
MAP_score:	@1	@3	@5	@10
		0.0411	0.0687	0.0829	0.0976	
NDCG_score:	@1	@3	@5	@10
		0.0411	0.0784	0.1041	0.1398	
[Epoch 23] HR@10 = 0.2800, best = 0.2936 (epoch 8)
[Epoch 24] Train BCE loss: 0.009365
num_hit:	@1	@3	@5	@10
		0.0400	0.1092	0.1684	0.2768	
MAP_score:	@1	@3	@5	@10
		0.0400	0.0693	0.0827	0.0971	
NDCG_score:	@1	@3	@5	@10
		0.0400	0.0795	0.1038	0.1388	
[Epoch 24] HR@10 = 0.2768, best = 0.2936 (epoch 8)
[Epoch 25] Train BCE loss: 0.006999
num_hit:	@1	@3	@5	@10
		0.0412	0.1090	0.1704	0.2818	
MAP_score:	@1	@3	@5	@10
		0.0412	0.0698	0.0836	0.0984	
NDCG_score:	@1	@3	@5	@10
		0.0412	0.0798	0.1049	0.1408	
[Epoch 25] HR@10 = 0.2818, best = 0.2936 (epoch 8)
[Epoch 26] Train BCE loss: 0.005125
num_hit:	@1	@3	@5	@10
		0.0408	0.1092	0.1702	0.2811	
MAP_score:	@1	@3	@5	@10
		0.0408	0.0701	0.0838	0.0985	
NDCG_score:	@1	@3	@5	@10
		0.0408	0.0801	0.1050	0.1408	
[Epoch 26] HR@10 = 0.2811, best = 0.2936 (epoch 8)
[Epoch 27] Train BCE loss: 0.003823
num_hit:	@1	@3	@5	@10
		0.0408	0.1122	0.1730	0.2837	
MAP_score:	@1	@3	@5	@10
		0.0408	0.0707	0.0844	0.0991	
NDCG_score:	@1	@3	@5	@10
		0.0408	0.0813	0.1061	0.1419	
[Epoch 27] HR@10 = 0.2837, best = 0.2936 (epoch 8)
[Epoch 28] Train BCE loss: 0.002813
num_hit:	@1	@3	@5	@10
		0.0396	0.1103	0.1722	0.2841	
MAP_score:	@1	@3	@5	@10
		0.0396	0.0694	0.0834	0.0982	
NDCG_score:	@1	@3	@5	@10
		0.0396	0.0799	0.1052	0.1413	
[Epoch 28] HR@10 = 0.2841, best = 0.2936 (epoch 8)
[Epoch 29] Train BCE loss: 0.002095
num_hit:	@1	@3	@5	@10
		0.0395	0.1114	0.1749	0.2854	
MAP_score:	@1	@3	@5	@10
		0.0395	0.0698	0.0841	0.0987	
NDCG_score:	@1	@3	@5	@10
		0.0395	0.0805	0.1064	0.1420	
[Epoch 29] HR@10 = 0.2854, best = 0.2936 (epoch 8)
[Epoch 30] Train BCE loss: 0.001558
num_hit:	@1	@3	@5	@10
		0.0391	0.1132	0.1763	0.2873	
MAP_score:	@1	@3	@5	@10
		0.0391	0.0703	0.0846	0.0992	
NDCG_score:	@1	@3	@5	@10
		0.0391	0.0813	0.1071	0.1429	
[Epoch 30] HR@10 = 0.2873, best = 0.2936 (epoch 8)
[Epoch 31] Train BCE loss: 0.001202
num_hit:	@1	@3	@5	@10
		0.0392	0.1124	0.1758	0.2857	
MAP_score:	@1	@3	@5	@10
		0.0392	0.0700	0.0843	0.0989	
NDCG_score:	@1	@3	@5	@10
		0.0392	0.0808	0.1068	0.1422	
[Epoch 31] HR@10 = 0.2857, best = 0.2936 (epoch 8)
[Epoch 32] Train BCE loss: 0.000919
num_hit:	@1	@3	@5	@10
		0.0389	0.1127	0.1768	0.2875	
MAP_score:	@1	@3	@5	@10
		0.0389	0.0700	0.0845	0.0991	
NDCG_score:	@1	@3	@5	@10
		0.0389	0.0809	0.1071	0.1428	
[Epoch 32] HR@10 = 0.2875, best = 0.2936 (epoch 8)
[Epoch 33] Train BCE loss: 0.000726
num_hit:	@1	@3	@5	@10
		0.0388	0.1125	0.1766	0.2863	
MAP_score:	@1	@3	@5	@10
		0.0388	0.0697	0.0841	0.0987	
NDCG_score:	@1	@3	@5	@10
		0.0388	0.0806	0.1068	0.1422	
[Epoch 33] HR@10 = 0.2863, best = 0.2936 (epoch 8)
[Epoch 34] Train BCE loss: 0.000581
num_hit:	@1	@3	@5	@10
		0.0382	0.1131	0.1762	0.2891	
MAP_score:	@1	@3	@5	@10
		0.0382	0.0697	0.0840	0.0989	
NDCG_score:	@1	@3	@5	@10
		0.0382	0.0808	0.1067	0.1431	
[Epoch 34] HR@10 = 0.2891, best = 0.2936 (epoch 8)
[Epoch 35] Train BCE loss: 0.000451
num_hit:	@1	@3	@5	@10
		0.0377	0.1140	0.1776	0.2896	
MAP_score:	@1	@3	@5	@10
		0.0377	0.0697	0.0840	0.0989	
NDCG_score:	@1	@3	@5	@10
		0.0377	0.0810	0.1070	0.1432	
[Epoch 35] HR@10 = 0.2896, best = 0.2936 (epoch 8)
[Epoch 36] Train BCE loss: 0.000368
num_hit:	@1	@3	@5	@10
		0.0366	0.1134	0.1796	0.2888	
MAP_score:	@1	@3	@5	@10
		0.0366	0.0688	0.0837	0.0982	
NDCG_score:	@1	@3	@5	@10
		0.0366	0.0802	0.1073	0.1424	
[Epoch 36] HR@10 = 0.2888, best = 0.2936 (epoch 8)
[Epoch 37] Train BCE loss: 0.000303
num_hit:	@1	@3	@5	@10
		0.0370	0.1131	0.1786	0.2890	
MAP_score:	@1	@3	@5	@10
		0.0370	0.0690	0.0839	0.0985	
NDCG_score:	@1	@3	@5	@10
		0.0370	0.0802	0.1071	0.1428	
[Epoch 37] HR@10 = 0.2890, best = 0.2936 (epoch 8)
[Epoch 38] Train BCE loss: 0.000244
num_hit:	@1	@3	@5	@10
		0.0357	0.1131	0.1790	0.2886	
MAP_score:	@1	@3	@5	@10
		0.0357	0.0683	0.0833	0.0979	
NDCG_score:	@1	@3	@5	@10
		0.0357	0.0797	0.1068	0.1423	
[Epoch 38] HR@10 = 0.2886, best = 0.2936 (epoch 8)
[Epoch 39] Train BCE loss: 0.000202
num_hit:	@1	@3	@5	@10
		0.0353	0.1136	0.1798	0.2888	
MAP_score:	@1	@3	@5	@10
		0.0353	0.0681	0.0831	0.0976	
NDCG_score:	@1	@3	@5	@10
		0.0353	0.0797	0.1068	0.1420	
[Epoch 39] HR@10 = 0.2888, best = 0.2936 (epoch 8)
[Epoch 40] Train BCE loss: 0.000167
num_hit:	@1	@3	@5	@10
		0.0337	0.1125	0.1793	0.2903	
MAP_score:	@1	@3	@5	@10
		0.0337	0.0670	0.0821	0.0969	
NDCG_score:	@1	@3	@5	@10
		0.0337	0.0786	0.1060	0.1419	
[Epoch 40] HR@10 = 0.2903, best = 0.2936 (epoch 8)
[Epoch 41] Train BCE loss: 0.000144
num_hit:	@1	@3	@5	@10
		0.0337	0.1125	0.1797	0.2904	
MAP_score:	@1	@3	@5	@10
		0.0337	0.0669	0.0820	0.0968	
NDCG_score:	@1	@3	@5	@10
		0.0337	0.0785	0.1060	0.1418	
[Epoch 41] HR@10 = 0.2904, best = 0.2936 (epoch 8)
[Epoch 42] Train BCE loss: 0.000122
num_hit:	@1	@3	@5	@10
		0.0329	0.1109	0.1791	0.2904	
MAP_score:	@1	@3	@5	@10
		0.0329	0.0660	0.0814	0.0963	
NDCG_score:	@1	@3	@5	@10
		0.0329	0.0775	0.1054	0.1414	
[Epoch 42] HR@10 = 0.2904, best = 0.2936 (epoch 8)
[Epoch 43] Train BCE loss: 0.000121
num_hit:	@1	@3	@5	@10
		0.0325	0.1120	0.1786	0.2897	
MAP_score:	@1	@3	@5	@10
		0.0325	0.0662	0.0813	0.0961	
NDCG_score:	@1	@3	@5	@10
		0.0325	0.0779	0.1052	0.1412	
[Epoch 43] HR@10 = 0.2897, best = 0.2936 (epoch 8)
[Epoch 44] Train BCE loss: 0.000092
num_hit:	@1	@3	@5	@10
		0.0323	0.1115	0.1822	0.2911	
MAP_score:	@1	@3	@5	@10
		0.0323	0.0658	0.0818	0.0964	
NDCG_score:	@1	@3	@5	@10
		0.0323	0.0775	0.1065	0.1417	
[Epoch 44] HR@10 = 0.2911, best = 0.2936 (epoch 8)
[Epoch 45] Train BCE loss: 0.000078
num_hit:	@1	@3	@5	@10
		0.0317	0.1109	0.1818	0.2914	
MAP_score:	@1	@3	@5	@10
		0.0317	0.0653	0.0813	0.0960	
NDCG_score:	@1	@3	@5	@10
		0.0317	0.0770	0.1060	0.1415	
[Epoch 45] HR@10 = 0.2914, best = 0.2936 (epoch 8)
[Epoch 46] Train BCE loss: 0.000062
num_hit:	@1	@3	@5	@10
		0.0307	0.1097	0.1830	0.2918	
MAP_score:	@1	@3	@5	@10
		0.0307	0.0642	0.0809	0.0954	
NDCG_score:	@1	@3	@5	@10
		0.0307	0.0759	0.1059	0.1411	
[Epoch 46] HR@10 = 0.2918, best = 0.2936 (epoch 8)
[Epoch 47] Train BCE loss: 0.000053
num_hit:	@1	@3	@5	@10
		0.0301	0.1103	0.1818	0.2911	
MAP_score:	@1	@3	@5	@10
		0.0301	0.0641	0.0803	0.0949	
NDCG_score:	@1	@3	@5	@10
		0.0301	0.0759	0.1052	0.1406	
[Epoch 47] HR@10 = 0.2911, best = 0.2936 (epoch 8)
[Epoch 48] Train BCE loss: 0.000046
num_hit:	@1	@3	@5	@10
		0.0301	0.1100	0.1816	0.2920	
MAP_score:	@1	@3	@5	@10
		0.0301	0.0641	0.0804	0.0952	
NDCG_score:	@1	@3	@5	@10
		0.0301	0.0759	0.1052	0.1410	
[Epoch 48] HR@10 = 0.2920, best = 0.2936 (epoch 8)
[Epoch 49] Train BCE loss: 0.000040
num_hit:	@1	@3	@5	@10
		0.0298	0.1103	0.1825	0.2918	
MAP_score:	@1	@3	@5	@10
		0.0298	0.0639	0.0803	0.0950	
NDCG_score:	@1	@3	@5	@10
		0.0298	0.0758	0.1054	0.1409	
[Epoch 49] HR@10 = 0.2918, best = 0.2936 (epoch 8)
[Epoch 50] Train BCE loss: 0.000035
num_hit:	@1	@3	@5	@10
		0.0286	0.1092	0.1816	0.2930	
MAP_score:	@1	@3	@5	@10
		0.0286	0.0628	0.0792	0.0942	
NDCG_score:	@1	@3	@5	@10
		0.0286	0.0747	0.1044	0.1405	
[Epoch 50] HR@10 = 0.2930, best = 0.2936 (epoch 8)
Training completed. Last model saved to checkpoints/ncf_last_filtered-h-and-m.pt
