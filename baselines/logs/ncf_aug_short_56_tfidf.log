Dataset: filtered-h-and-m, Users: 1371716, Items: 105491
Generating training data...
[Epoch 1] Train BCE loss: 0.359463
num_hit:	@1	@3	@5	@10
		0.0115	0.0386	0.0611	0.1176	
MAP_score:	@1	@3	@5	@10
		0.0115	0.0227	0.0277	0.0351	
NDCG_score:	@1	@3	@5	@10
		0.0115	0.0267	0.0359	0.0540	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_tfidf.csv
âœ… [Epoch 1] New best HR@10: 0.1176 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 2] Train BCE loss: 0.249150
num_hit:	@1	@3	@5	@10
		0.0172	0.0521	0.0821	0.1488	
MAP_score:	@1	@3	@5	@10
		0.0172	0.0317	0.0383	0.0471	
NDCG_score:	@1	@3	@5	@10
		0.0172	0.0369	0.0491	0.0705	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_tfidf.csv
âœ… [Epoch 2] New best HR@10: 0.1488 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 3] Train BCE loss: 0.212160
num_hit:	@1	@3	@5	@10
		0.0282	0.0784	0.1220	0.1996	
MAP_score:	@1	@3	@5	@10
		0.0282	0.0497	0.0596	0.0697	
NDCG_score:	@1	@3	@5	@10
		0.0282	0.0570	0.0750	0.0998	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_tfidf.csv
âœ… [Epoch 3] New best HR@10: 0.1996 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 4] Train BCE loss: 0.171380
num_hit:	@1	@3	@5	@10
		0.0367	0.1033	0.1534	0.2449	
MAP_score:	@1	@3	@5	@10
		0.0367	0.0649	0.0763	0.0884	
NDCG_score:	@1	@3	@5	@10
		0.0367	0.0747	0.0953	0.1248	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_tfidf.csv
âœ… [Epoch 4] New best HR@10: 0.2449 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 5] Train BCE loss: 0.151233
num_hit:	@1	@3	@5	@10
		0.0418	0.1174	0.1728	0.2714	
MAP_score:	@1	@3	@5	@10
		0.0418	0.0738	0.0864	0.0992	
NDCG_score:	@1	@3	@5	@10
		0.0418	0.0849	0.1077	0.1393	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_tfidf.csv
âœ… [Epoch 5] New best HR@10: 0.2714 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 6] Train BCE loss: 0.137472
num_hit:	@1	@3	@5	@10
		0.0416	0.1219	0.1796	0.2862	
MAP_score:	@1	@3	@5	@10
		0.0416	0.0755	0.0886	0.1028	
NDCG_score:	@1	@3	@5	@10
		0.0416	0.0873	0.1111	0.1455	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_tfidf.csv
âœ… [Epoch 6] New best HR@10: 0.2862 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 7] Train BCE loss: 0.127629
num_hit:	@1	@3	@5	@10
		0.0458	0.1246	0.1849	0.2978	
MAP_score:	@1	@3	@5	@10
		0.0458	0.0787	0.0923	0.1073	
NDCG_score:	@1	@3	@5	@10
		0.0458	0.0904	0.1151	0.1515	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_tfidf.csv
âœ… [Epoch 7] New best HR@10: 0.2978 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 8] Train BCE loss: 0.119826
num_hit:	@1	@3	@5	@10
		0.0448	0.1198	0.1818	0.2980	
MAP_score:	@1	@3	@5	@10
		0.0448	0.0763	0.0904	0.1059	
NDCG_score:	@1	@3	@5	@10
		0.0448	0.0874	0.1128	0.1504	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_tfidf.csv
âœ… [Epoch 8] New best HR@10: 0.2980 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 9] Train BCE loss: 0.113034
num_hit:	@1	@3	@5	@10
		0.0428	0.1182	0.1812	0.3029	
MAP_score:	@1	@3	@5	@10
		0.0428	0.0746	0.0888	0.1049	
NDCG_score:	@1	@3	@5	@10
		0.0428	0.0857	0.1115	0.1507	
ðŸ“„ Saved batch eval result to result/ncf_result_aug_short_56_tfidf.csv
âœ… [Epoch 9] New best HR@10: 0.3029 â€“ model saved to checkpoints/ncf_filtered-h-and-m_best.pt
[Epoch 10] Train BCE loss: 0.106531
num_hit:	@1	@3	@5	@10
		0.0434	0.1184	0.1758	0.2985	
MAP_score:	@1	@3	@5	@10
		0.0434	0.0749	0.0881	0.1042	
NDCG_score:	@1	@3	@5	@10
		0.0434	0.0860	0.1097	0.1491	
[Epoch 10] HR@10 = 0.2985, best = 0.3029 (epoch 9)
[Epoch 11] Train BCE loss: 0.100284
num_hit:	@1	@3	@5	@10
		0.0416	0.1188	0.1765	0.2939	
MAP_score:	@1	@3	@5	@10
		0.0416	0.0743	0.0873	0.1027	
NDCG_score:	@1	@3	@5	@10
		0.0416	0.0856	0.1093	0.1470	
[Epoch 11] HR@10 = 0.2939, best = 0.3029 (epoch 9)
[Epoch 12] Train BCE loss: 0.093858
num_hit:	@1	@3	@5	@10
		0.0425	0.1159	0.1741	0.2864	
MAP_score:	@1	@3	@5	@10
		0.0425	0.0733	0.0864	0.1014	
NDCG_score:	@1	@3	@5	@10
		0.0425	0.0842	0.1080	0.1442	
[Epoch 12] HR@10 = 0.2864, best = 0.3029 (epoch 9)
[Epoch 13] Train BCE loss: 0.087205
num_hit:	@1	@3	@5	@10
		0.0418	0.1152	0.1736	0.2846	
MAP_score:	@1	@3	@5	@10
		0.0418	0.0728	0.0860	0.1005	
NDCG_score:	@1	@3	@5	@10
		0.0418	0.0836	0.1075	0.1431	
[Epoch 13] HR@10 = 0.2846, best = 0.3029 (epoch 9)
[Epoch 14] Train BCE loss: 0.080606
num_hit:	@1	@3	@5	@10
		0.0420	0.1173	0.1718	0.2826	
MAP_score:	@1	@3	@5	@10
		0.0420	0.0737	0.0859	0.1004	
NDCG_score:	@1	@3	@5	@10
		0.0420	0.0848	0.1071	0.1426	
[Epoch 14] HR@10 = 0.2826, best = 0.3029 (epoch 9)
[Epoch 15] Train BCE loss: 0.073676
num_hit:	@1	@3	@5	@10
		0.0408	0.1134	0.1675	0.2781	
MAP_score:	@1	@3	@5	@10
		0.0408	0.0716	0.0839	0.0984	
NDCG_score:	@1	@3	@5	@10
		0.0408	0.0823	0.1045	0.1401	
[Epoch 15] HR@10 = 0.2781, best = 0.3029 (epoch 9)
[Epoch 16] Train BCE loss: 0.066736
num_hit:	@1	@3	@5	@10
		0.0431	0.1118	0.1671	0.2771	
MAP_score:	@1	@3	@5	@10
		0.0431	0.0721	0.0846	0.0992	
NDCG_score:	@1	@3	@5	@10
		0.0431	0.0822	0.1049	0.1404	
[Epoch 16] HR@10 = 0.2771, best = 0.3029 (epoch 9)
[Epoch 17] Train BCE loss: 0.059792
num_hit:	@1	@3	@5	@10
		0.0422	0.1095	0.1688	0.2775	
MAP_score:	@1	@3	@5	@10
		0.0422	0.0706	0.0841	0.0985	
NDCG_score:	@1	@3	@5	@10
		0.0422	0.0806	0.1049	0.1399	
[Epoch 17] HR@10 = 0.2775, best = 0.3029 (epoch 9)
[Epoch 18] Train BCE loss: 0.052848
num_hit:	@1	@3	@5	@10
		0.0408	0.1128	0.1684	0.2794	
MAP_score:	@1	@3	@5	@10
		0.0408	0.0708	0.0834	0.0980	
NDCG_score:	@1	@3	@5	@10
		0.0408	0.0816	0.1043	0.1400	
[Epoch 18] HR@10 = 0.2794, best = 0.3029 (epoch 9)
[Epoch 19] Train BCE loss: 0.046012
num_hit:	@1	@3	@5	@10
		0.0402	0.1089	0.1680	0.2795	
MAP_score:	@1	@3	@5	@10
		0.0402	0.0696	0.0829	0.0976	
NDCG_score:	@1	@3	@5	@10
		0.0402	0.0797	0.1038	0.1397	
[Epoch 19] HR@10 = 0.2795, best = 0.3029 (epoch 9)
[Epoch 20] Train BCE loss: 0.039391
num_hit:	@1	@3	@5	@10
		0.0395	0.1074	0.1675	0.2784	
MAP_score:	@1	@3	@5	@10
		0.0395	0.0682	0.0819	0.0966	
NDCG_score:	@1	@3	@5	@10
		0.0395	0.0782	0.1029	0.1387	
[Epoch 20] HR@10 = 0.2784, best = 0.3029 (epoch 9)
[Epoch 21] Train BCE loss: 0.033208
num_hit:	@1	@3	@5	@10
		0.0401	0.1082	0.1672	0.2784	
MAP_score:	@1	@3	@5	@10
		0.0401	0.0687	0.0821	0.0968	
NDCG_score:	@1	@3	@5	@10
		0.0401	0.0788	0.1030	0.1388	
[Epoch 21] HR@10 = 0.2784, best = 0.3029 (epoch 9)
[Epoch 22] Train BCE loss: 0.027392
num_hit:	@1	@3	@5	@10
		0.0384	0.1074	0.1684	0.2807	
MAP_score:	@1	@3	@5	@10
		0.0384	0.0674	0.0812	0.0960	
NDCG_score:	@1	@3	@5	@10
		0.0384	0.0776	0.1026	0.1387	
[Epoch 22] HR@10 = 0.2807, best = 0.3029 (epoch 9)
[Epoch 23] Train BCE loss: 0.022135
num_hit:	@1	@3	@5	@10
		0.0382	0.1071	0.1702	0.2808	
MAP_score:	@1	@3	@5	@10
		0.0382	0.0672	0.0813	0.0959	
NDCG_score:	@1	@3	@5	@10
		0.0382	0.0774	0.1031	0.1387	
[Epoch 23] HR@10 = 0.2808, best = 0.3029 (epoch 9)
[Epoch 24] Train BCE loss: 0.017544
num_hit:	@1	@3	@5	@10
		0.0380	0.1071	0.1691	0.2872	
MAP_score:	@1	@3	@5	@10
		0.0380	0.0669	0.0809	0.0965	
NDCG_score:	@1	@3	@5	@10
		0.0380	0.0771	0.1025	0.1405	
[Epoch 24] HR@10 = 0.2872, best = 0.3029 (epoch 9)
[Epoch 25] Train BCE loss: 0.013712
num_hit:	@1	@3	@5	@10
		0.0371	0.1075	0.1726	0.2882	
MAP_score:	@1	@3	@5	@10
		0.0371	0.0665	0.0811	0.0964	
NDCG_score:	@1	@3	@5	@10
		0.0371	0.0770	0.1035	0.1407	
[Epoch 25] HR@10 = 0.2882, best = 0.3029 (epoch 9)
[Epoch 26] Train BCE loss: 0.010561
num_hit:	@1	@3	@5	@10
		0.0369	0.1094	0.1708	0.2869	
MAP_score:	@1	@3	@5	@10
		0.0369	0.0671	0.0809	0.0964	
NDCG_score:	@1	@3	@5	@10
		0.0369	0.0779	0.1030	0.1405	
[Epoch 26] HR@10 = 0.2869, best = 0.3029 (epoch 9)
[Epoch 27] Train BCE loss: 0.008148
num_hit:	@1	@3	@5	@10
		0.0365	0.1082	0.1716	0.2882	
MAP_score:	@1	@3	@5	@10
		0.0365	0.0666	0.0810	0.0964	
NDCG_score:	@1	@3	@5	@10
		0.0365	0.0773	0.1032	0.1408	
[Epoch 27] HR@10 = 0.2882, best = 0.3029 (epoch 9)
[Epoch 28] Train BCE loss: 0.006121
num_hit:	@1	@3	@5	@10
		0.0360	0.1078	0.1726	0.2900	
MAP_score:	@1	@3	@5	@10
		0.0360	0.0661	0.0807	0.0962	
NDCG_score:	@1	@3	@5	@10
		0.0360	0.0768	0.1032	0.1410	
[Epoch 28] HR@10 = 0.2900, best = 0.3029 (epoch 9)
[Epoch 29] Train BCE loss: 0.004671
num_hit:	@1	@3	@5	@10
		0.0366	0.1054	0.1727	0.2922	
MAP_score:	@1	@3	@5	@10
		0.0366	0.0657	0.0809	0.0968	
NDCG_score:	@1	@3	@5	@10
		0.0366	0.0758	0.1034	0.1420	
[Epoch 29] HR@10 = 0.2922, best = 0.3029 (epoch 9)
[Epoch 30] Train BCE loss: 0.003568
num_hit:	@1	@3	@5	@10
		0.0355	0.1082	0.1735	0.2924	
MAP_score:	@1	@3	@5	@10
		0.0355	0.0661	0.0806	0.0964	
NDCG_score:	@1	@3	@5	@10
		0.0355	0.0768	0.1034	0.1418	
[Epoch 30] HR@10 = 0.2924, best = 0.3029 (epoch 9)
[Epoch 31] Train BCE loss: 0.002738
num_hit:	@1	@3	@5	@10
		0.0336	0.1062	0.1731	0.2924	
MAP_score:	@1	@3	@5	@10
		0.0336	0.0641	0.0792	0.0951	
NDCG_score:	@1	@3	@5	@10
		0.0336	0.0749	0.1022	0.1408	
[Epoch 31] HR@10 = 0.2924, best = 0.3029 (epoch 9)
[Epoch 32] Train BCE loss: 0.002132
num_hit:	@1	@3	@5	@10
		0.0341	0.1086	0.1760	0.2949	
MAP_score:	@1	@3	@5	@10
		0.0341	0.0655	0.0807	0.0964	
NDCG_score:	@1	@3	@5	@10
		0.0341	0.0765	0.1041	0.1424	
[Epoch 32] HR@10 = 0.2949, best = 0.3029 (epoch 9)
[Epoch 33] Train BCE loss: 0.001697
num_hit:	@1	@3	@5	@10
		0.0335	0.1065	0.1762	0.2962	
MAP_score:	@1	@3	@5	@10
		0.0335	0.0643	0.0801	0.0959	
NDCG_score:	@1	@3	@5	@10
		0.0335	0.0751	0.1037	0.1423	
[Epoch 33] HR@10 = 0.2962, best = 0.3029 (epoch 9)
[Epoch 34] Train BCE loss: 0.001348
num_hit:	@1	@3	@5	@10
		0.0335	0.1071	0.1759	0.2969	
MAP_score:	@1	@3	@5	@10
		0.0335	0.0647	0.0803	0.0962	
NDCG_score:	@1	@3	@5	@10
		0.0335	0.0755	0.1037	0.1426	
[Epoch 34] HR@10 = 0.2969, best = 0.3029 (epoch 9)
[Epoch 35] Train BCE loss: 0.001099
num_hit:	@1	@3	@5	@10
		0.0333	0.1074	0.1759	0.2976	
MAP_score:	@1	@3	@5	@10
		0.0333	0.0646	0.0802	0.0963	
NDCG_score:	@1	@3	@5	@10
		0.0333	0.0756	0.1037	0.1429	
[Epoch 35] HR@10 = 0.2976, best = 0.3029 (epoch 9)
[Epoch 36] Train BCE loss: 0.000897
num_hit:	@1	@3	@5	@10
		0.0334	0.1079	0.1754	0.2985	
MAP_score:	@1	@3	@5	@10
		0.0334	0.0647	0.0800	0.0963	
NDCG_score:	@1	@3	@5	@10
		0.0334	0.0757	0.1034	0.1431	
[Epoch 36] HR@10 = 0.2985, best = 0.3029 (epoch 9)
[Epoch 37] Train BCE loss: 0.000740
num_hit:	@1	@3	@5	@10
		0.0325	0.1074	0.1785	0.2969	
MAP_score:	@1	@3	@5	@10
		0.0325	0.0638	0.0798	0.0955	
NDCG_score:	@1	@3	@5	@10
		0.0325	0.0749	0.1040	0.1422	
[Epoch 37] HR@10 = 0.2969, best = 0.3029 (epoch 9)
[Epoch 38] Train BCE loss: 0.000613
num_hit:	@1	@3	@5	@10
		0.0321	0.1085	0.1787	0.2985	
MAP_score:	@1	@3	@5	@10
		0.0321	0.0643	0.0802	0.0959	
NDCG_score:	@1	@3	@5	@10
		0.0321	0.0756	0.1044	0.1429	
[Epoch 38] HR@10 = 0.2985, best = 0.3029 (epoch 9)
[Epoch 39] Train BCE loss: 0.000506
num_hit:	@1	@3	@5	@10
		0.0311	0.1074	0.1784	0.2979	
MAP_score:	@1	@3	@5	@10
		0.0311	0.0628	0.0789	0.0947	
NDCG_score:	@1	@3	@5	@10
		0.0311	0.0742	0.1033	0.1418	
[Epoch 39] HR@10 = 0.2979, best = 0.3029 (epoch 9)
[Epoch 40] Train BCE loss: 0.000425
num_hit:	@1	@3	@5	@10
		0.0299	0.1088	0.1788	0.3000	
MAP_score:	@1	@3	@5	@10
		0.0299	0.0627	0.0786	0.0946	
NDCG_score:	@1	@3	@5	@10
		0.0299	0.0745	0.1032	0.1422	
[Epoch 40] HR@10 = 0.3000, best = 0.3029 (epoch 9)
[Epoch 41] Train BCE loss: 0.000361
num_hit:	@1	@3	@5	@10
		0.0305	0.1079	0.1789	0.3002	
MAP_score:	@1	@3	@5	@10
		0.0305	0.0628	0.0789	0.0948	
NDCG_score:	@1	@3	@5	@10
		0.0305	0.0743	0.1034	0.1424	
[Epoch 41] HR@10 = 0.3002, best = 0.3029 (epoch 9)
[Epoch 42] Train BCE loss: 0.000309
num_hit:	@1	@3	@5	@10
		0.0287	0.1074	0.1781	0.3020	
MAP_score:	@1	@3	@5	@10
		0.0287	0.0618	0.0778	0.0941	
NDCG_score:	@1	@3	@5	@10
		0.0287	0.0734	0.1024	0.1423	
[Epoch 42] HR@10 = 0.3020, best = 0.3029 (epoch 9)
[Epoch 43] Train BCE loss: 0.000266
num_hit:	@1	@3	@5	@10
		0.0281	0.1072	0.1781	0.3002	
MAP_score:	@1	@3	@5	@10
		0.0281	0.0613	0.0774	0.0935	
NDCG_score:	@1	@3	@5	@10
		0.0281	0.0730	0.1021	0.1414	
[Epoch 43] HR@10 = 0.3002, best = 0.3029 (epoch 9)
[Epoch 44] Train BCE loss: 0.000220
num_hit:	@1	@3	@5	@10
		0.0271	0.1076	0.1793	0.3019	
MAP_score:	@1	@3	@5	@10
		0.0271	0.0608	0.0770	0.0932	
NDCG_score:	@1	@3	@5	@10
		0.0271	0.0728	0.1021	0.1416	
[Epoch 44] HR@10 = 0.3019, best = 0.3029 (epoch 9)
[Epoch 45] Train BCE loss: 0.000191
num_hit:	@1	@3	@5	@10
		0.0272	0.1064	0.1795	0.3014	
MAP_score:	@1	@3	@5	@10
		0.0272	0.0604	0.0770	0.0931	
NDCG_score:	@1	@3	@5	@10
		0.0272	0.0722	0.1022	0.1414	
[Epoch 45] HR@10 = 0.3014, best = 0.3029 (epoch 9)
[Epoch 46] Train BCE loss: 0.000161
num_hit:	@1	@3	@5	@10
		0.0261	0.1058	0.1787	0.3028	
MAP_score:	@1	@3	@5	@10
		0.0261	0.0594	0.0760	0.0924	
NDCG_score:	@1	@3	@5	@10
		0.0261	0.0713	0.1012	0.1412	
[Epoch 46] HR@10 = 0.3028, best = 0.3029 (epoch 9)
[Epoch 47] Train BCE loss: 0.000136
num_hit:	@1	@3	@5	@10
		0.0246	0.1062	0.1796	0.3029	
MAP_score:	@1	@3	@5	@10
		0.0246	0.0588	0.0755	0.0917	
NDCG_score:	@1	@3	@5	@10
		0.0246	0.0709	0.1010	0.1407	
[Epoch 47] HR@10 = 0.3029, best = 0.3029 (epoch 9)
[Epoch 48] Train BCE loss: 0.000137
num_hit:	@1	@3	@5	@10
		0.0255	0.1052	0.1784	0.3011	
MAP_score:	@1	@3	@5	@10
		0.0255	0.0587	0.0754	0.0918	
NDCG_score:	@1	@3	@5	@10
		0.0255	0.0706	0.1007	0.1403	
[Epoch 48] HR@10 = 0.3011, best = 0.3029 (epoch 9)
[Epoch 49] Train BCE loss: 0.000121
num_hit:	@1	@3	@5	@10
		0.0258	0.1058	0.1773	0.3011	
MAP_score:	@1	@3	@5	@10
		0.0258	0.0589	0.0752	0.0917	
NDCG_score:	@1	@3	@5	@10
		0.0258	0.0709	0.1003	0.1403	
[Epoch 49] HR@10 = 0.3011, best = 0.3029 (epoch 9)
[Epoch 50] Train BCE loss: 0.000089
num_hit:	@1	@3	@5	@10
		0.0244	0.1052	0.1796	0.3026	
MAP_score:	@1	@3	@5	@10
		0.0244	0.0579	0.0748	0.0911	
NDCG_score:	@1	@3	@5	@10
		0.0244	0.0700	0.1005	0.1401	
[Epoch 50] HR@10 = 0.3026, best = 0.3029 (epoch 9)
Training completed. Last model saved to checkpoints/ncf_last_filtered-h-and-m.pt
